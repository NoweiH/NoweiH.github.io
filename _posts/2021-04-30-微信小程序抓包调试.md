---
layout: post
title: "微信小程序抓包调试"
date: 2021-04-30
description: "反编译微信小程序，断点调试解密算法"
tag: JavaScript
---   

　　经过各种找资料，踩过各种坑，终于使用微信开发者工具，完美进行了几次小程序的Js算法解密。好吧，废话不多说了，开始吧。     

　　本篇文章只是记录个人的学习到的技术点，读者有什么问题可以先仔细看看文章，或者搜下关键字，如果还是有问题可以给我在评论里给我留言，问题很着急的可以加我 ＱＱ：1833889889，如果本篇文章真的有帮助到你，不胜荣幸！
 

## 背景
   
　微信小程序算法解密一直是本人很好奇的事情，在写这篇文章之前，我还是一个遇到小程序加密算法就跳过的傻der，心里有好奇过小程序的算法是如何进行解密的。之前听过搞开发小程序的大牛说过可以通过反编译小程序源码，利用工具进行调试，进而得到加密算法的说法，但是由于懒癌未付诸行动。

　最近看到好多大佬有自己的博客，我也跟风搭建了这么一个简简单单的个人小站，一方面是给自己做笔记，可以提升自己的写作、总结能力，一个技术点我们会使用，并不难，但是要做到让让别人也能听懂我们讲得，还是需要一定的技巧和经验的。很多类似于CSDN、博客园也都可以写文章，但是页面的样式我，不是太喜欢，简书还算好点得。本篇文章就是搭建成功后的第一篇处女座，废话不多说，咱们开始吧。
 
## 配置环境     

### 安装Node.js（必须）         


到Node.js[官网](https://nodejs.org/)下载相应平台的最新版本，一路安装即可。

### 微信开发者工具（必须）     
作用：利用反编译后的源码进行断点调试
[微信开发者工具](https://xiazai.sogou.com/detail/34/16/3742959004653918870.html?e=1970)

### Root过的真机（必须）

手机如何Root不用多说，这些教程网上有大把的帖子视频可供参考，这里我就不提供方法了。恰巧，如果你没有真机的话，大可以买一个piexl，让卖家帮你刷好面具（现在绝大部分卖家都提供这个服务）

### Mt文件管理器(也可以Re)
作用：提取每次打开小程序缓存到手机上的原始包　
[Mt文件管理](https://www.coolapk.com/apk/bin.mt.plus)
当上面必要的工具环境都准备好了之后，我们就要开始配置反编译小程序源码的依赖

### 初始化
  当上面我说的所有工具环境你均已安装配置完成后，打开CMD命令行，输入

```
node -v
```

  即可返回你当前安装的node版本号，如返回其他，重新配置系统环境变量
直至成功返回node的版本号
好啦，至此，全部安装工作已经完成！

### 安装反编译依赖
  安装小程序反编译依赖是很无脑的事情，几句代码无脑输入回车即可。代码贴下方：

```
npm install esprima

npm install css-tree

npm install cssbeautify

npm install vm2

npm install uglify-es

npm install js-beautify

npm install escodegen

npm install cheerio
```

反编译依赖安装成功之后，我们就要开始进行小程序的反编译工作了，不要高兴！工先利其事必先利其器，我们要先找好小程序反编译脚本，这里贴上[解包脚本](https://github.com/qwerty472123/wxappUnpacker)

### 找到小程序缓存的文件
小程序缓存到手机上面的目录是固定的：
/data/data/com.tencent.mm/MicroMsg/XXX....../appbrand/pkg
其中XXX......是因为每个手机上面的文件夹名字不同，只能这么代替，但是你可以根据我这张图片应该可以找到具体的文件位置。
![](/images/113559ieg6iqlvh7ybbpvh.gif)
找到缓存文件之后，打包发送到你的电脑我们接着进行下一步反编译操作。

### 反编译小程序：

每个人的反编译工具都不相同，我这里我就以自己的工具为例，拿到缓存的小程序文件之后打开CMD使用命令：

```
node wuWxapkg.js 需要反编译文件全路径
```

如：‪C:\Users\Administrator\Desktop\达达\_962684693_313.wxapkg

反编译成功后，你会得到看到输出跟我大致内容的文本：
![](/images/%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8F%8D%E7%BC%96%E8%AF%91.png)
在原来缓存文件的目录下会保存一个已_962684693_313命名的文件夹。
到此，我们的微信小程序反编译工作已经算是完成，我们把反编译后的文件夹导入微信开发者工具即可进行调试抓包的进一步操作，当你打开之后你会发现，又是熟悉的网页调试，可以愉快的玩耍啦！


转载请注明原地址，Nowei - 无为 的博客：[Nowei - 无为](https://noweih.github.io/)谢谢！
